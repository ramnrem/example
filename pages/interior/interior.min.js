let bprev = $('.banner').parent().find('.banner-nav_prev')
let bnext = $('.banner').parent().find('.banner-nav_next')
if($('.banner').length > 0) {
    $('.banner').slick({
        prevArrow: bprev,
        nextArrow: bnext
    });
}
    
if($('.fancy-link').length > 0) {
    $('.fancy-link').fancybox({});
}

$('.kcard-wrap').on('click', function() {
    if(!$(this).hasClass('active')){
        let index = $(this).index();
        let target = ($('.dish-menu').find('.dish-menu__list')[index])

        $(this).parent().find('.active').toggleClass('active')
        $(this).toggleClass('active')

        $('.dish-menu').find('.active').toggleClass('active')
        $(target).toggleClass('active')
    }
})

if($('#map').length > 0) {

    ymaps.ready(init);
    function init(){ 
        var myMap = new ymaps.Map("map", {
            center: [55.785923, 37.675828],
            zoom: 7,
            controls: []
        });

        var placemark = new ymaps.Placemark([55.785923, 37.675828]);

        myMap.geoObjects.add(placemark);
    }
}

let nsprev = $('.news-slider').parent().find('.banner-nav_prev')
let nsnext = $('.news-slider').parent().find('.banner-nav_next')


if($('.news-slider').length > 0) {
    $('.news-slider').slick({
        prevArrow: nsprev,
        nextArrow: nsnext,
        slidesToShow: 2,
        slidesToScroll: 2,
        responsive: [
            {
              breakpoint: 1043,
              settings: {
                dots: true
              }
            },
            {
              breakpoint: 598,
              settings: {
                dots: true,
                slidesToShow: 1,
                slidesToScroll: 1,
              },
              
            }
        ]

    })
}
    


let aboutTag = function() {
    if(window.innerWidth < 598){
        let el = $('.about-tag__text_left').parent().find('img')
        let p = $('.about-tag__text_left').parent()

        if($('.about-tag').first() != el) {
            p.prepend(el)
        }
    } else {
        let el = $('.about-tag__text_left').parent().find('img')
        let p = $('.about-tag__text_left').parent()

        if($('.about-tag').first() != el) {
            el.appendTo(p)
        }
    }
}
let indexNew = function() {

    if(window.innerWidth < 846){
        let el = $('.index-new__desc')
        let el2 = $('.index-new__link')
        let p = $('.index-new__border')

        for( elm of p) {
            if( elm.childElementCount == 2) {
                $(elm).find(el).appendTo(elm)
                $(elm).find(el2).appendTo(elm)
            } else break;
        }

    } else {
        let el = $('.index-new__desc')
        let el2 = $('.index-new__link')
        let p = $('.index-new__border')

        for( elm of p) {
            console.log('iteration')
            if( elm.childElementCount > 2) {
                $(elm).find(el).appendTo($(elm).find('.index-new__text'))
                $(elm).find(el2).appendTo($(elm).find('.index-new__text'))
            } else break;
        }
    }
}

let postText = function(){
    if(window.innerWidth < 598){
        let el = $('.post__text')
        let p = $('.post')

        for( elm of p) {
            if( elm.childElementCount == 3) {
                $(elm).find(el).insertBefore($(elm).find('.line-title'))
            } else break;
        }

    } else {
        let el = $('.post__text')
        let p = $('.post')

        for( elm of p) {
            if( elm.childElementCount > 3) {
                $(elm).find(el).appendTo($(elm).find('.post__info'))
            } else break;
        }
    }
}


$(document).ready(function(){
    aboutTag();
    indexNew();
    postText();
})

$(window).on('resize', function() {
    aboutTag();
    indexNew();
    postText();
})

$('.mheader__burger').on('click', function() {
    $('.mobile-menu').slideToggle()
})

let rprev = $('.review-slider').parent().find('.banner-nav_prev')
let rnext = $('.review-slider').parent().find('.banner-nav_next')

if($('.review-slider').length > 0) {
    $('.review-slider').slick({
        prevArrow: rprev,
        nextArrow: rnext,
        slidesToShow: 2,
        slidesToScroll: 2,
        responsive: [
            {
              breakpoint: 1043,
              settings: {
                dots: true
              }
            },
            {
              breakpoint: 598,
              settings: {
                dots: true,
                slidesToShow: 1,
                slidesToScroll: 1,
              },
              
            }
        ]

    })
}